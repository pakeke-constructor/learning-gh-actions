

name: build_project

on: push



jobs:
  darklua:
    runs-on: ubuntu-20.04

    steps:
    - uses: actions/checkout@v3
      with:
        path: main

    - uses: actions/checkout@v3
      with:
        name: seaofvoices/darklua
        path: darklua
        refs: 7410329ddf73907c421080d782b2e1860fb84aa8

    - name: Debug
      run: tree

    - name: Build Darklua
      run: |
        cd darklua
        cargo build --locked --release --target x86_64-unknown-linux-gnu
      env:
        CARGO_TARGET_DIR: output

    - name: Darklua Preprocessing
      run: |
        sudo chmod +x ./darklua/output/darklua
        sudo ./darklua/output/darklua process main main --config main/.darklua.json

    - name: Debug
      run: echo cat ./main/my_proj/my_file.lua



